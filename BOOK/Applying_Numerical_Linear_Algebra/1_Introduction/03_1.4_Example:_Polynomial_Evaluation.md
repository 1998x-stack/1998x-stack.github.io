# 03_1.4_Example:_Polynomial_Evaluation

"""
Lecture: /1_Introduction
Content: 03_1.4_Example:_Polynomial_Evaluation
"""

### 03_1.4 例子：多项式求值 (Example: Polynomial Evaluation)

#### 引言

多项式求值是数值分析中的基本问题之一。它不仅在理论上有深远的意义，而且在实际应用中也非常普遍。例如，在计算机图形学、物理模拟和金融数学等领域，都需要高效且准确地进行多项式求值。

#### 多项式的定义

- **多项式形式**：一个 $d$ 次多项式可以表示为：
  $$
  p(x) = \sum_{i=0}^{d} a_i x^i
  $$
  其中，$a_i$ 是多项式的系数。

#### Horner方法

Horner方法是一种高效的多项式求值方法，通过将多项式重写为嵌套形式来减少计算的次数。

- **Horner形式**：将 $ p(x) $ 写为嵌套乘积的形式：
  $$
  p(x) = a_d + x (a_{d-1} + x (a_{d-2} + \cdots + x (a_1 + x a_0) \cdots ))
  $$
- **Horner算法**：
  ```python
  p = a_d
  for i = d-1 downto 0:
      p = x * p + a_i
  ```

#### 误差分析

在进行多项式求值时，由于计算机的浮点运算精度有限，舍入误差会影响计算结果。误差分析的目的是评估和控制这些误差。

- **舍入误差模型**：假设每个浮点运算 $ * $ 和 $ + $ 都引入一个相对误差 $\delta_i$，其中 $ |\delta_i| \leq \epsilon $，$\epsilon$ 是机器精度。
  - **计算步骤中的舍入误差**：
    $$
    p_i = ((x \cdot p_{i+1})(1 + \delta_i) + a_i)(1 + \delta'_i)
    $$
    其中，$|\delta_i|, |\delta'_i| \leq \epsilon$。

- **误差传播**：
  $$
  p_0 = \sum_{i=0}^{d} (1 + \delta'_i) \left( \prod_{j=0}^{i-1} (1 + \delta_j)(1 + \delta'_j) \right) a_i x^i
  $$
  为了简化分析，可以使用上下界来近似这些乘积：
  $$
  (1 - d\epsilon) \leq \prod_{j=0}^{d-1} (1 + \delta_j) \leq (1 + d\epsilon)
  $$

- **最终误差界**：
  $$
  |p_0 - p(x)| \leq 2d\epsilon \sum_{i=0}^{d} |a_i x^i|
  $$
  这里，$\sum_{i=0}^{d} |a_i x^i|$ 是在没有正负数抵消的情况下，可能的最大计算值。

#### 条件数

条件数反映了问题对输入扰动的敏感性。在多项式求值中，条件数定义为：
  $$
  \kappa = \frac{\sum_{i=0}^{d} |a_i x^i|}{|p(x)|}
  $$
  - **高条件数**：意味着小的输入误差会导致大的输出误差。
  - **低条件数**：意味着问题对输入误差不敏感。

#### 多项式零点求解中的应用

Horner方法不仅用于多项式求值，还广泛应用于多项式的零点求解算法中，如二分法（Bisection Method）：

- **二分法步骤**：
  1. 选择一个包含根的区间 $[x_{\text{low}}, x_{\text{high}}]$，使得 $p(x_{\text{low}}) \cdot p(x_{\text{high}}) < 0$。
  2. 计算中点 $x_{\text{mid}} = (x_{\text{low}} + x_{\text{high}})/2$。
  3. 判断 $p(x_{\text{mid}})$ 的符号并缩小区间：
     - 如果 $p(x_{\text{mid}}) \cdot p(x_{\text{low}}) < 0$，则根在 $[x_{\text{low}}, x_{\text{mid}}]$。
     - 否则，根在 $[x_{\text{mid}}, x_{\text{high}}]$。
  4. 重复以上步骤，直到区间足够小。

### 深入分析

#### Horner方法的优缺点

- **优点**：
  - **计算效率高**：Horner方法通过减少乘法运算次数，提高了计算效率。对于一个 $d$ 次多项式，Horner方法只需 $d$ 次乘法和 $d$ 次加法。
  - **数值稳定性好**：Horner方法在避免数值误差累积方面表现较好，特别是在系数和变量的数值范围较大时。

- **缺点**：
  - **灵活性差**：Horner方法对多项式的特定形式（即嵌套形式）有要求，对于某些特殊多项式（如系数为大数或小数）可能不太适用。
  - **局限性**：在某些情况下，如高次多项式或复杂根的计算中，Horner方法可能会受到数值不稳定性的影响。

#### 条件数与数值稳定性

- **条件数的重要性**：条件数是评估数值问题稳定性的关键指标。高条件数意味着问题对输入误差非常敏感，可能导致不可靠的结果。
- **数值稳定性**：一个算法称为数值稳定，如果它对输入的微小扰动不敏感，能产生稳定的输出结果。Horner方法被认为是数值稳定的，因为它能有效地控制舍入误差的累积。

#### 多项式求值的实际应用

- **计算机图形学**：在图形变换和曲线绘制中，多项式求值用于计算Bezier曲线和B样条曲线的点。
- **物理模拟**：在模拟物理现象（如运动学和动力学）时，多项式求值用于计算物体的位置、速度和加速度。
- **金融数学**：在金融模型（如期权定价和风险管理）中，多项式求值用于计算收益和损失的概率分布。

通过深入分析可以看出，多项式求值是数值线性代数中的基础问题。通过选择合适的算法（如Horner方法）和进行误差分析，可以提高计算效率和结果的可靠性。条件数作为重要指标，帮助我们理解和控制计算中的数值稳定性。