# 00_3.2.1_Normal_Equations

"""
Lecture: 3_Linear_Least_Squares_Problems/3.2_Matrix_Factorizations_That_Solve_the_Linear_Least_Squares_Problem
Content: 00_3.2.1_Normal_Equations
"""

### 3.2.1 正规方程法

#### 背景
在线性最小二乘问题中，我们的目标是找到一个向量 $ x $，使得矩阵 $ A $ 与向量 $ b $ 之间的距离最小化，即：
$$ \min_x \|Ax - b\|_2 $$

对于这个优化问题，可以通过正规方程（Normal Equations）来求解。正规方程将最小二乘问题转化为一个更容易求解的线性方程组。

#### 推导过程

1. **最小化目标函数**
   我们的目标是最小化以下二次型目标函数：
   $$ f(x) = \|Ax - b\|_2^2 $$
   这个目标函数可以展开为：
   $$ f(x) = (Ax - b)^T (Ax - b) $$
   
2. **梯度计算**
   为了找到使目标函数最小的 $ x $，我们需要计算目标函数的梯度，并使其为零。首先，计算梯度：
   $$ \nabla f(x) = \nabla [(Ax - b)^T (Ax - b)] $$

3. **梯度展开**
   通过链式法则展开梯度：
   $$ \nabla f(x) = 2A^T(Ax - b) $$
   
4. **设梯度为零**
   为了找到最小值点，我们令梯度为零：
   $$ 2A^T(Ax - b) = 0 $$
   这简化为：
   $$ A^T A x = A^T b $$

5. **正规方程**
   上述方程即为正规方程。求解该方程可以得到最小二乘解：
   $$ x = (A^T A)^{-1} A^T b $$

#### 正规方程的性质

1. **正定性**
   矩阵 $ A^T A $ 是对称的，并且对于满秩矩阵 $ A $，矩阵 $ A^T A $ 还是正定的。这意味着 $ A^T A $ 存在逆矩阵。

2. **凸性**
   目标函数 $ f(x) $ 是一个严格凸函数，这意味着任何临界点都是全局最小点。因此，通过求解正规方程得到的解即为全局最小解。

3. **解的唯一性**
   当 $ A $ 满秩时，矩阵 $ A^T A $ 是正定的，从而其逆矩阵存在，因此解 $ x $ 是唯一的。

#### 实际应用

1. **曲线拟合**
   在数据拟合中，正规方程常用于多项式拟合和其他曲线拟合问题。例如，给定一组数据点，通过正规方程可以找到最佳拟合曲线。

2. **统计建模**
   正规方程也用于线性回归模型的参数估计。在统计学中，最小二乘法是估计线性模型参数的标准方法。

3. **大地测量**
   在大地测量中，通过测量点之间的角度和距离，使用正规方程可以提高定位的精度。

#### 正规方程的局限性

1. **数值稳定性**
   正规方程法的数值稳定性较差，特别是在矩阵 $ A $ 的条件数较大时。因为矩阵 $ A^T A $ 的条件数是矩阵 $ A $ 条件数的平方，这可能导致数值误差显著放大。

2. **高计算复杂度**
   计算 $ A^T A $ 和 $ A^T b $ 需要 $ O(n^2 m) $ 次浮点运算，其中 $ n $ 和 $ m $ 分别是矩阵 $ A $ 的列数和行数。然后求解方程组 $ A^T A x = A^T b $ 需要 $ O(n^3) $ 次运算。对于大型问题，这种计算代价可能过高。