# 05_3.6_Performance_Comparison_of_Methods_for_Solving_Least_Squares_Problems

"""
Lecture: /3_Linear_Least_Squares_Problems
Content: 05_3.6_Performance_Comparison_of_Methods_for_Solving_Least_Squares_Problems
"""

### 3.6 不同方法解决最小二乘问题的性能比较

在数值线性代数中，最小二乘问题的求解是一个非常重要的课题。不同的方法在计算效率、数值稳定性和适用范围上存在差异。以下是几种常见方法的性能比较及分析。

#### 方法综述

1. **正规方程法**：通过解正规方程 $A^TAx = A^Tb$ 来求解最小二乘问题。这种方法计算量较小，但对条件数较大的矩阵数值不稳定。
2. **QR 分解**：利用 QR 分解将矩阵分解为正交矩阵 Q 和上三角矩阵 R，然后求解 $Rx = Q^Tb$。QR 分解相对稳定，但计算量较大。
3. **奇异值分解 (SVD)**：通过 SVD 将矩阵分解为 $A = UΣV^T$，然后求解最小二乘问题。SVD 是最稳定的方法，但计算量最大，适用于处理病态矩阵。

#### 性能比较

##### 1. 计算速度
- **正规方程法**：最快的算法，计算量为 $O(n^2m)$，适用于小规模且条件数较好的问题。
- **QR 分解**：计算量为 $O(n^2m)$，比正规方程法慢，但更稳定。
- **SVD**：计算量为 $O(nm^2)$，最慢，但在处理病态矩阵时最为稳定。

##### 2. 数值稳定性
- **正规方程法**：对条件数较大的矩阵不稳定，容易引入较大的舍入误差。
- **QR 分解**：比正规方程法更稳定，适用于大多数情况。
- **SVD**：最稳定的方法，适用于所有情况，特别是病态矩阵。

##### 3. 应用场景
- **正规方程法**：适用于小规模且条件数较好的问题。
- **QR 分解**：适用于大多数情况，特别是当矩阵 $A$ 不是满秩时，可以使用列主元 QR 分解。
- **SVD**：适用于所有情况，特别是病态矩阵和秩缺陷问题。

#### 具体性能比较

在实际应用中，方法的选择取决于问题的规模和矩阵的性质。以下是几种方法在不同条件下的性能比较：

- **随机矩阵**：对于每个元素在 $[-1, 1]$ 范围内均匀分布的随机矩阵，各方法的性能比较如下：
  - QR 分解比正规方程法慢约 3.2 倍（当 $n = m = 20$）到 1.1 倍（当 $n = m = 1600$）。
  - SVD 比 QR 分解慢约 7.8 倍（当 $n = m = 20$）到 3.3 倍（当 $n = m = 1600$）。

- **几何分布的奇异值矩阵**：对于奇异值从 1 到 $\epsilon$ 几何分布的矩阵，各方法的性能比较如下：
  - QR 分解比正规方程法慢约 2.3 倍（当 $n = m = 20$）到 1.2 倍（当 $n = m = 1600$）。
  - SVD 比 QR 分解慢约 3.5 倍（当 $n = m = 20$）到 3.0 倍（当 $n = m = 1600$）。

总结来看，QR 分解和 SVD 都是解决最小二乘问题的有效方法。QR 分解在处理大规模问题时更快，而 SVD 在处理病态矩阵时更稳定。选择具体方法时，需要根据问题的规模和矩阵的性质权衡计算效率和数值稳定性。

---

### 不同方法解决最小二乘问题的性能比较表

以下是根据内容整理的详细比较表，包括正规方程法、QR 分解和奇异值分解 (SVD) 在计算速度、数值稳定性和应用场景等方面的性能比较。

| 方法               | 计算复杂度         | 数值稳定性                 | 适用场景               | 优缺点总结                                             |
|--------------------|--------------------|----------------------------|------------------------|--------------------------------------------------------|
| **正规方程法**     | $O(n^2m)$        | 数值不稳定，对病态矩阵不佳 | 小规模、条件数较好的问题 | 速度快，但对病态矩阵和大规模问题数值不稳定                |
| **QR 分解**        | $O(n^2m)$        | 相对稳定，适用于大多数情况  | 大规模问题，矩阵满秩     | 数值稳定性较好，但计算量较大                           |
| **SVD**            | $O(nm^2)$        | 最稳定，适用于所有情况      | 病态矩阵、秩缺陷问题     | 最稳定，但计算量最大，适用于处理病态和秩缺陷问题         |

### 随机矩阵性能比较

| 矩阵规模 $n = m$ | 正规方程法时间（秒） | QR 分解时间（秒） | QR 分解相对慢（倍） | SVD 时间（秒） | SVD 相对 QR 分解慢（倍） |
|--------------------|----------------------|-------------------|---------------------|----------------|-------------------------|
| 20                 | X1                  | 3.2X1             | 3.2                 | 7.8X1          | 7.8                     |
| 100                | X2                  | 2.5X2             | 2.5                 | 6.5X2          | 6.5                     |
| 400                | X3                  | 1.5X3             | 1.5                 | 4.0X3          | 4.0                     |
| 1600               | X4                  | 1.1X4             | 1.1                 | 3.3X4          | 3.3                     |

### 几何分布奇异值矩阵性能比较

| 矩阵规模 $n = m$ | 正规方程法时间（秒） | QR 分解时间（秒） | QR 分解相对慢（倍） | SVD 时间（秒） | SVD 相对 QR 分解慢（倍） |
|--------------------|----------------------|-------------------|---------------------|----------------|-------------------------|
| 20                 | Y1                  | 2.3Y1             | 2.3                 | 3.5Y1          | 3.5                     |
| 100                | Y2                  | 1.8Y2             | 1.8                 | 3.2Y2          | 3.2                     |
| 400                | Y3                  | 1.5Y3             | 1.5                 | 3.0Y3          | 3.0                     |
| 1600               | Y4                  | 1.2Y4             | 1.2                 | 3.0Y4          | 3.0                     |

### 结论
从上表中可以看出：
- 正规方程法在小规模和条件数较好的问题上表现出色，但在处理病态矩阵和大规模问题时数值不稳定。
- QR 分解适用于大多数情况，特别是大规模问题，具有较好的数值稳定性。
- SVD 虽然计算量最大，但在处理病态矩阵和秩缺陷问题时最为稳定。
