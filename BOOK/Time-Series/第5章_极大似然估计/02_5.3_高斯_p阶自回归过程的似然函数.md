# 02_5.3 高斯 p阶自回归过程的似然函数

"""
Lecture: /第5章 极大似然估计
Content: 02_5.3 高斯 p阶自回归过程的似然函数
"""

### 第5章 极大似然估计

#### 5.3 高斯 p阶自回归过程的似然函数

本节内容详细介绍了高斯p阶自回归过程（AR(p)）的似然函数及其在极大似然估计中的应用。以下是对本节内容的详细分析。

---

#### 1. 高斯 p阶自回归过程（AR(p)）

**定义**：
- **AR(p)过程** 是一种扩展的一阶自回归模型，用于描述当前值与前p个滞后值之间的线性关系。其定义为：

$$ X_t = \phi_1 X_{t-1} + \phi_2 X_{t-2} + \cdots + \phi_p X_{t-p} + \epsilon_t $$

其中，$ \epsilon_t $ 是均值为0、方差为 $ \sigma^2 $ 的高斯白噪声过程，$ \phi_1, \phi_2, \ldots, \phi_p $ 是模型参数。

**性质**：
- **平稳性**：当所有特征根的绝对值都小于1时，AR(p)过程是平稳的。
- **自相关函数**：AR(p)过程的自相关函数在滞后阶数大于p时为零。

---

#### 2. 似然函数

**定义**：
- **似然函数** 表示在给定参数下，观测数据出现的概率。对于AR(p)过程，似然函数可以表示为：

$$ L(\theta; X) = P(X | \theta) $$

其中，$ \theta $ 是参数向量，包含 $ \phi_1, \phi_2, \ldots, \phi_p $ 和 $ \sigma^2 $，$ X $ 是观测数据。

**公式**：
- 对于观测值 $ X_1, X_2, \ldots, X_n $，AR(p)过程的似然函数可以写为：

$$ L(\phi_1, \phi_2, \ldots, \phi_p, \sigma^2; X) = \left( \frac{1}{2\pi\sigma^2} \right)^{n/2} \exp \left( -\frac{1}{2\sigma^2} \sum_{t=p+1}^{n} (X_t - \sum_{i=1}^{p} \phi_i X_{t-i})^2 \right) $$

- 对数似然函数（Log-Likelihood Function）为：

$$ \ln L(\phi_1, \phi_2, \ldots, \phi_p, \sigma^2; X) = -\frac{n}{2} \ln (2\pi\sigma^2) - \frac{1}{2\sigma^2} \sum_{t=p+1}^{n} (X_t - \sum_{i=1}^{p} \phi_i X_{t-i})^2 $$

---

#### 3. 极大似然估计

**步骤**：

1. **构建似然函数**：根据AR(p)过程定义，构建似然函数或对数似然函数。
2. **求解导数**：对对数似然函数分别对 $ \phi_i $ 和 $ \sigma^2 $ 求导数。
3. **设导数为零**：求解一阶导数等于零的方程，得到参数的估计值。
4. **验证结果**：通过二阶导数检验，验证所得解是否为极大值。

**公式推导**：

- 对数似然函数对 $ \phi_i $ 的导数为：

$$ \frac{\partial \ln L}{\partial \phi_i} = \frac{1}{\sigma^2} \sum_{t=p+1}^{n} (X_t - \sum_{j=1}^{p} \phi_j X_{t-j}) X_{t-i} $$

- 对数似然函数对 $ \sigma^2 $ 的导数为：

$$ \frac{\partial \ln L}{\partial \sigma^2} = -\frac{n-p}{2\sigma^2} + \frac{1}{2\sigma^4} \sum_{t=p+1}^{n} (X_t - \sum_{j=1}^{p} \phi_j X_{t-j})^2 $$

- 设导数为零，解得参数估计值：

$$ \hat{\phi_i} = \left( \sum_{t=p+1}^{n} X_{t-i} X_{t-j} \right)^{-1} \sum_{t=p+1}^{n} X_t X_{t-i} $$

$$ \hat{\sigma}^2 = \frac{1}{n-p} \sum_{t=p+1}^{n} (X_t - \sum_{j=1}^{p} \hat{\phi_j} X_{t-j})^2 $$

---

#### 4. 实例分析

**步骤**：

1. **数据准备**：收集和预处理时间序列数据，确保数据平稳。
2. **模型选择**：通过自相关函数（ACF）和偏自相关函数（PACF）图，初步确定模型阶数。
3. **参数估计**：使用极大似然估计方法，估计AR(p)模型参数。
4. **模型检验**：通过残差分析和信息准则（如AIC、BIC），验证模型的拟合效果。
5. **模型预测**：使用拟合好的模型，对未来时间点进行预测，并评估预测效果。

**实例**：

假设我们有一组时间序列数据 $ \{X_t\} $，通过分析确定其为 AR(2) 模型：

$$ X_t = \phi_1 X_{t-1} + \phi_2 X_{t-2} + \epsilon_t $$

构建似然函数并进行极大似然估计，得到参数 $ \hat{\phi_1}, \hat{\phi_2} $ 和 $ \hat{\sigma}^2 $ 的估计值。验证模型的拟合效果并进行未来值的预测。

---

#### 5. 结论

高斯p阶自回归过程（AR(p））的似然函数通过最大化对数似然函数，可以准确估计模型参数。极大似然估计方法在时间序列分析中具有重要应用，通过这种方法可以有效地估计模型参数并进行预测。其在经济、金融等领域的时间序列建模和预测中具有广泛的应用前景。