# 00_6.1 总体谱

"""
Lecture: /第6章 谱分析
Content: 00_6.1 总体谱
"""

## 6.1 总体谱分析极致详细解析

### 1. 总体谱概述
总体谱（Spectral Density）是时间序列分析中的一种工具，用于描述时间序列在不同频率上的能量分布。通过总体谱，可以了解时间序列在频域上的特性，这是频域分析的重要组成部分。总体谱是自协方差函数的傅里叶变换，它提供了时间序列信号在不同频率上的强度信息。

### 2. 总体谱的数学定义
假设$\{X_t\}$是一个零均值平稳时间序列，其自协方差函数为$\gamma(h)$，满足$\sum_{h=-\infty}^{\infty}|\gamma(h)| < \infty$。总体谱$f(\lambda)$定义为：
$$ f(\lambda) = \frac{1}{2\pi} \sum_{h=-\infty}^{\infty} e^{-ih\lambda} \gamma(h), \quad -\infty < \lambda < \infty $$
这里，$\lambda$ 表示频率，自协方差函数 $\gamma(h)$ 描述了时间序列在不同时刻之间的依赖关系。

### 3. 总体谱的基本性质
总体谱$f(\lambda)$具有以下基本性质：
1. **对称性**：总体谱是一个偶函数，即 $f(\lambda) = f(-\lambda)$。这意味着频率为 $\lambda$ 和 $-\lambda$ 处的能量是相同的。
2. **非负性**：总体谱在所有频率下均为非负值，即 $f(\lambda) \geq 0$。这反映了能量的非负性。
3. **归一化**：总体谱的积分等于时间序列的方差，即 $\int_{-\pi}^{\pi} f(\lambda) d\lambda = \gamma(0)$。
4. **自协方差函数的关系**：自协方差函数 $\gamma(k)$ 可以通过总体谱的逆傅里叶变换表示：
$$ \gamma(k) = \int_{-\pi}^{\pi} e^{ik\lambda} f(\lambda) d\lambda $$
这表明总体谱与自协方差函数之间存在一一对应关系。

### 4. 总体谱的推导过程
总体谱的推导涉及对时间序列的频域分析。以下是推导过程的详细步骤：

#### 4.1 自协方差函数的傅里叶变换
总体谱的定义是自协方差函数 $\gamma(h)$ 的傅里叶变换。首先，通过时间序列的自协方差函数 $\gamma(h)$ 来描述序列在不同时刻的依赖关系。然后，计算其傅里叶变换：
$$ f(\lambda) = \frac{1}{2\pi} \sum_{h=-\infty}^{\infty} \gamma(h) e^{-ih\lambda} $$

#### 4.2 频域表示
时间序列在频域上的表示是通过离散傅里叶变换（DFT）实现的。对于一个长度为 $n$ 的时间序列 $\{x_t\}$，其离散傅里叶变换定义为：
$$ a_k = \frac{1}{\sqrt{n}} \sum_{t=1}^n x_t e^{-it\omega_k} $$
其中 $\omega_k = \frac{2\pi k}{n}$ 是频率。通过傅里叶变换，时间序列可以表示为：
$$ x_t = \sum_{k=-\left[\frac{n-1}{2}\right]}^{\left[\frac{n}{2}\right]} a_k e^{it\omega_k} $$
这些系数 $a_k$ 被称为时间序列的离散傅里叶变换（DFT）系数。

### 5. 样本总体谱估计
在实际应用中，我们需要对总体谱进行估计。样本总体谱的估计通常通过计算样本周期图（Periodogram）来实现。样本周期图 $I_n(\lambda)$ 定义为：
$$ I_n(\lambda) = \frac{1}{2\pi n} \left| \sum_{t=1}^n x_t e^{-it\lambda} \right|^2 $$
周期图 $I_n(\lambda)$ 可以看作是总体谱 $f(\lambda)$ 的一个无偏估计。当样本量 $n$ 足够大时，$I_n(\lambda)$ 会收敛于 $f(\lambda)$。

### 6. 总体谱在不同模型中的应用
不同时间序列模型的总体谱有不同的特性。以下是几个常见模型的总体谱特性：

#### 6.1.1 白噪声的总体谱
如果 $\{X_t\}$ 是一个白噪声过程（即 $\gamma(0) = \sigma^2$ 和 $\gamma(h) = 0$ 对于所有 $|h| > 0$），则其总体谱是一个常数：
$$ f(\lambda) = \frac{\sigma^2}{2\pi} $$
这表明白噪声在所有频率上均匀分布。

#### 6.1.2 AR(1) 过程的总体谱
对于 AR(1) 过程 $X_t = \phi X_{t-1} + Z_t$，其中 $\{Z_t\}$ 是零均值白噪声过程，其总体谱为：
$$ f(\lambda) = \frac{\sigma^2}{2\pi (1 - 2\phi \cos(\lambda) + \phi^2)} $$
这里，$\phi$ 是模型参数。该公式表明 AR(1) 过程的频谱在低频处有较高的能量。

#### 6.1.3 MA(1) 过程的总体谱
对于 MA(1) 过程 $X_t = Z_t + \theta Z_{t-1}$，其总体谱为：
$$ f(\lambda) = \frac{\sigma^2}{2\pi} (1 + \theta^2 + 2\theta \cos(\lambda)) $$
其中 $\theta$ 是模型参数。该公式表明 MA(1) 过程的频谱在频率 $\lambda$ 处具有对称性。

### 7. 总体谱的实际应用
总体谱在实际应用中具有广泛用途，以下是几个典型应用场景：

#### 7.1 结构设计中的应用
在结构设计中，通过分析加载力的总体谱，可以识别出显著的正弦分量，从而避免结构共振频率的存在。例如，在桥梁设计中，需要确保桥梁的自然频率与行车频率不发生共振，以避免结构损坏。

#### 7.2 信号处理中的应用
在信号处理领域，总体谱分析用于信号去噪、滤波和特征提取。例如，在语音信号处理中，通过分析语音信号的频谱特性，可以实现语音识别和语音增强。

#### 7.3 经济和金融数据分析中的应用
在经济和金融数据分析中，总体谱用于检测周期性趋势和市场波动。例如，通过分析股票价格的频谱，可以识别出潜在的周期性模式，从而辅助投资决策。

#### 7.4 气象数据分析中的应用
在气象数据分析中，总体谱用于分析气温、降水量等气象数据的周期性变化。例如，通过分析多年气温数据的频谱，可以识别出季节性和年际变化模式，从而预测未来的气候变化。

### 8. 总体谱估计的数值方法
在实际应用中，通常使用快速傅里叶变换（FFT）来计算时间序列的离散傅里叶变换，从而估计总体谱。以下是一个简单的数值计算步骤：

1. **数据预处理**：对时间序列数据进行去趋势和去季节性处理，确保数据平稳。
2. **计算DFT**：使用快速傅里叶变换（FFT）计算时间序列的离散傅里叶变换系数 $a_k$。
3. **计算周期图**：根据DFT系数计算样本周期图 $I_n(\lambda)$。
4. **平滑处理**：对周期图进行平滑处理，以获得更加平滑的总体谱估计。

### 9. 结论
总体谱分析是时间序列分析中的重要工具，通过频域分析提供了一种新的视角，帮助我们更好地理解时间序列的频率特性。总体谱在实际应用中具有广泛的用途，从结构设计到信号处理，再到经济和气象数据分析，总体谱分析为各领域的研究和实践提供了有力支持。
