
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <title>3.4 自回归过程</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=STIX+Two+Math&display=swap">
  <link rel="stylesheet" href="../markdown.css">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="../markdown.js"></script>
</head>
<body>
  <div class="container">
    <h1>03_3.4 自回归过程</h1>
<pre><code>Lecture: /第3章 平稳自回归移动平均过程
Content: 03_3.4 自回归过程
</code></pre>
<h3>第3章 平稳自回归移动平均过程</h3>
<h4>3.4 自回归过程</h4>
<p>自回归过程（Autoregressive Process，简称AR过程）是时间序列分析中最基本的模型之一，用于描述时间序列数据的自身回归特性。第3章第3.4节详细介绍了自回归过程的定义、性质及其在实际中的应用。</p>
<h4>自回归过程的定义</h4>
<p>自回归过程是指当前时间序列值由其前若干期的值的线性组合所决定。一般形式的AR(p)模型可以表示为：</p>
<p>$$ X_t = \phi_1 X_{t-1} + \phi_2 X_{t-2} + \cdots + \phi_p X_{t-p} + \epsilon_t $$</p>
<p>其中：</p>
<ul>
<li>$ X_t $ 是时间序列在时间 $ t $ 的值。</li>
<li>$ \phi_1, \phi_2, \cdots, \phi_p $ 是模型参数。</li>
<li>$ \epsilon_t $ 是白噪声序列，即均值为零且方差为 $ \sigma^2 $ 的独立同分布随机变量。</li>
</ul>
<h4>自回归过程的性质</h4>
<ol>
<li><strong>平稳性</strong>：AR(p)过程的平稳性取决于其特征方程的根。如果特征方程的所有根都在单位圆之外，则该过程是平稳的。特征方程为：</li>
</ol>
<p>$$ 1 - \phi_1 z - \phi_2 z^2 - \cdots - \phi_p z^p = 0 $$</p>
<ol start="2">
<li>
<p><strong>自相关函数</strong>：自回归过程的自相关函数（ACF）在滞后 $ k $ 时的值可以通过模型参数计算得到。对于平稳的AR(p)过程，自相关函数逐渐衰减。</p>
</li>
<li>
<p><strong>偏自相关函数</strong>：偏自相关函数（PACF）在滞后 $ k $ 时的值表示当前值与滞后 $ k $ 期值之间的线性关系，排除了中间滞后值的影响。对于AR(p)过程，PACF在滞后 $ p $ 之后迅速衰减为零。</p>
</li>
</ol>
<h4>自回归过程的应用</h4>
<p>自回归过程在时间序列分析中有广泛的应用，特别是在建模和预测时间序列数据时具有重要作用。以下是几个典型的应用场景：</p>
<ol>
<li><strong>经济和金融数据分析</strong>：在股票价格、利率等金融数据中，AR模型常用于描述和预测数据的短期波动和趋势。</li>
<li><strong>气象数据分析</strong>：气象数据如温度、降水量等，可以通过AR模型分析其变化趋势和周期性。</li>
<li><strong>工程和信号处理</strong>：在工程应用中，AR模型用于分析和预测信号的动态变化，如电力负荷预测等。</li>
</ol>
<h4>AR过程的模型识别和估计</h4>
<ol>
<li>
<p><strong>模型识别</strong>：通过分析时间序列的自相关函数（ACF）和偏自相关函数（PACF）图，可以确定AR模型的阶数。对于AR(p)模型，PACF在滞后 $ p $ 时显著，滞后 $ p+1 $ 及以后迅速衰减为零。</p>
</li>
<li>
<p><strong>参数估计</strong>：常用的方法包括Yule-Walker方程和极大似然估计法。通过历史数据，可以估计模型参数 $ \phi_1, \phi_2, \cdots, \phi_p $。</p>
</li>
<li>
<p><strong>模型验证</strong>：通过残差分析和诊断检查，验证所建模型的合理性和有效性。残差应呈现白噪声特性，即均值为零且无自相关。</p>
</li>
</ol>
<h3>实例分析</h3>
<p>假设我们有一个AR(2)模型：</p>
<p>$$ X_t = \phi_1 X_{t-1} + \phi_2 X_{t-2} + \epsilon_t $$</p>
<p>我们可以通过以下步骤进行分析和建模：</p>
<ol>
<li><strong>识别模型</strong>：通过绘制时间序列的ACF和PACF图，发现PACF在滞后2时显著，滞后3及以后迅速衰减为零，初步确定为AR(2)模型。</li>
<li><strong>估计参数</strong>：使用历史数据，采用Yule-Walker方程或极大似然估计法估计参数 $ \phi_1 $ 和 $ \phi_2 $。</li>
<li><strong>验证模型</strong>：分析残差的ACF图，检查残差是否呈现白噪声特性，若满足，则模型有效。</li>
</ol>
<h3>总结</h3>
<p>自回归过程是时间序列分析中的基础模型，通过描述时间序列的自相关性，提供了有效的建模和预测方法。理解和掌握AR模型的定义、性质和应用，有助于更准确地分析和预测实际时间序列数据。</p>

    <h3>Python 文件</h3>
    <pre><code># 03_3.4 自回归过程

"""
Lecture: /第3章 平稳自回归移动平均过程
Content: 03_3.4 自回归过程
"""

import numpy as np
from typing import List

class AutoregressiveProcess:
    """
    自回归过程类，用于生成和分析AR(p)模型。

    Attributes:
        coefficients (List[float]): AR模型的参数列表
        order (int): AR模型的阶数
    """

    def __init__(self, coefficients: List[float]):
        """
        初始化自回归过程。

        Args:
            coefficients (List[float]): AR模型的参数列表
        """
        self.coefficients = np.array(coefficients)
        self.order = len(coefficients)
    
    def generate_samples(self, n_samples: int, noise_variance: float = 1.0) -> np.ndarray:
        """
        生成自回归过程的样本序列。

        Args:
            n_samples (int): 生成样本的数量
            noise_variance (float): 噪声方差，默认值为1.0

        Returns:
            np.ndarray: 生成的AR过程样本序列
        """
        # 初始化样本序列
        samples = np.zeros(n_samples)
        # 生成白噪声序列
        white_noise = np.random.normal(scale=np.sqrt(noise_variance), size=n_samples)
        
        # 生成AR过程样本
        for t in range(self.order, n_samples):
            samples[t] = np.dot(self.coefficients, samples[t-self.order:t][::-1]) + white_noise[t]
        
        return samples

    def estimate_parameters(self, samples: np.ndarray) -> np.ndarray:
        """
        使用Yule-Walker方程估计AR模型参数。

        Args:
            samples (np.ndarray): 样本序列

        Returns:
            np.ndarray: 估计的AR模型参数
        """
        from scipy.linalg import toeplitz

        # 计算自相关函数
        r = np.correlate(samples, samples, mode='full')[len(samples)-1:]
        r = r[:self.order+1]
        
        # 构建Toeplitz矩阵
        R = toeplitz(r[:-1])
        r = r[1:]
        
        # 计算AR模型参数
        phi_hat = np.linalg.solve(R, r)
        
        return phi_hat

def main():
    """
    主函数，演示自回归过程的使用。
    """
    # 定义AR(2)模型的参数
    coefficients = [0.75, -0.25]
    ar_process = AutoregressiveProcess(coefficients)
    
    # 生成AR过程样本
    n_samples = 100
    noise_variance = 1.0
    samples = ar_process.generate_samples(n_samples, noise_variance)
    
    # 打印生成的样本序列的前10个值
    print("Generated AR process samples (first 10 samples):")
    print(samples[:10])
    
    # 使用Yule-Walker方程估计AR模型参数
    estimated_coefficients = ar_process.estimate_parameters(samples)
    
    # 打印估计的参数
    print("Estimated AR process coefficients:")
    print(estimated_coefficients)

if __name__ == "__main__":
    main()</code></pre>
  </div>
</body>
</html>
  