# 01_3.5.2_旋转

"""
Lecture: 03._数据结构/3.5_红黑树
Content: 01_3.5.2_旋转
"""

### 3.5.2 旋转

#### 旋转的概念

旋转是红黑树中的一种关键操作，用于维护树的平衡性。旋转操作分为左旋和右旋两种，通过局部调整树的结构，使树保持平衡，从而确保查找、插入和删除操作的高效性。旋转操作在红黑树的插入和删除过程中起到了至关重要的作用。

#### 左旋和右旋

##### 左旋

左旋操作是将某个节点向左下方移动，使其右子节点上升成为新的父节点。左旋操作的具体步骤如下：

1. 假设有一个节点 $x$，其右子节点为 $y$。
2. 将 $y$ 的左子节点 $T2$ 移动为 $x$ 的右子节点。
3. 将 $y$ 设为 $x$ 的父节点，$x$ 成为 $y$ 的左子节点。

左旋操作的效果是将树的局部结构进行调整，使得右子树的高度减少，左子树的高度增加，从而维持树的平衡。

##### 右旋

右旋操作与左旋操作相反，将某个节点向右下方移动，使其左子节点上升成为新的父节点。右旋操作的具体步骤如下：

1. 假设有一个节点 $x$，其左子节点为 $y$。
2. 将 $y$ 的右子节点 $T2$ 移动为 $x$ 的左子节点。
3. 将 $y$ 设为 $x$ 的父节点，$x$ 成为 $y$ 的右子节点。

右旋操作的效果是将树的局部结构进行调整，使得左子树的高度减少，右子树的高度增加，从而维持树的平衡。

#### 旋转操作的应用

红黑树在执行插入和删除操作时，通过旋转操作来维持树的平衡。具体来说，红黑树在插入和删除节点后，需要进行以下调整：

1. **插入操作后的调整**：
   - 新插入的节点初始时总是红色的。
   - 如果插入节点的父节点也是红色的，则违反了红黑树的性质，需要进行调整。
   - 通过旋转和重新着色操作，恢复红黑树的平衡。

2. **删除操作后的调整**：
   - 删除节点可能会破坏红黑树的平衡，需要进行调整。
   - 通过旋转和重新着色操作，确保红黑树的性质不被破坏。

##### 插入后的旋转调整

当新节点插入后，如果插入的节点和其父节点都是红色的，则需要进行旋转和重新着色来恢复红黑树的平衡。具体步骤如下：

1. 如果插入节点的父节点和叔叔节点都是红色的：
   - 将父节点和叔叔节点都重新着色为黑色。
   - 将祖父节点重新着色为红色。
   - 将当前节点指向祖父节点，继续检查。

2. 如果插入节点的父节点是红色，叔叔节点是黑色或不存在：
   - 通过旋转和重新着色来修复红黑树的性质。

##### 删除后的旋转调整

当删除节点后，可能会导致红黑树的性质被破坏，需要进行旋转和重新着色来恢复平衡。具体步骤如下：

1. 如果被删除节点或其子节点是黑色的：
   - 通过一系列的旋转和重新着色操作，恢复红黑树的平衡。

#### 旋转的复杂度

左旋和右旋操作的时间复杂度都是 $O(1)$，因为每次旋转只涉及常数个节点的指针调整和颜色更改。这使得红黑树在执行插入和删除操作时，即使需要多次旋转和重新着色，整体时间复杂度仍然保持在 $O(\log n)$。

### 总结

旋转是红黑树中维护树平衡的关键操作，通过左旋和右旋操作，可以局部调整树的结构，确保树的高度在最坏情况下保持对数级别。红黑树在插入和删除操作后，通过旋转和重新着色来恢复树的平衡，从而保证查找、插入和删除操作的高效性。理解旋转操作的原理和应用，对于掌握红黑树的实现和优化至关重要。