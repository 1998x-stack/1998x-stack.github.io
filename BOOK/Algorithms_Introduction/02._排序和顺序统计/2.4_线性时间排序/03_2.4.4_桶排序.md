# 03_2.4.4_桶排序

"""
Lecture: 02._排序和顺序统计/2.4_线性时间排序
Content: 03_2.4.4_桶排序
"""

### 2.4.4 桶排序

桶排序（Bucket Sort）是一种线性时间排序算法，适用于均匀分布的数据。它的基本思想是将输入数据分布到多个桶中，然后对每个桶内的数据分别进行排序，最后将所有桶中的数据按顺序合并。

#### 算法描述

桶排序的过程可以分为以下几个步骤：

1. **创建桶**：根据数据的范围和数量创建若干个桶。
2. **分配数据**：遍历输入数组，将每个数据项分配到对应的桶中。
3. **桶内排序**：对每个非空桶中的数据进行排序，可以使用插入排序或其他合适的排序算法。
4. **合并桶**：将所有桶中的数据合并，得到排序后的数组。

#### 详细步骤

1. **创建桶**：
   - 假设输入数组为 $A[1 \ldots n]$，我们创建一个辅助数组 $B[0 \ldots n-1]$，其中每个元素都是一个空列表。
   
2. **分配数据**：
   - 对于每个元素 $A[i]$，将其分配到桶 $B[\lfloor n \cdot A[i] \rfloor]$ 中。这里假设所有输入数据均在 $[0, 1)$ 区间内。

3. **桶内排序**：
   - 对每个非空桶中的数据进行排序。这里我们可以使用插入排序，因为插入排序在处理小规模数据时非常高效。

4. **合并桶**：
   - 按顺序遍历所有桶，将桶中的数据依次放入结果数组中。

#### 算法伪代码

以下是桶排序的伪代码：
```
BUCKET-SORT(A, n)
1. 让 B[0 \ldots n-1] 为一个新数组
2. for i = 0 to n-1
3.    将 B[i] 置为空列表
4. for i = 1 to n
5.    将 A[i] 插入到 B[⎣n * A[i]⎦]
6. for i = 0 to n-1
7.    用插入排序对列表 B[i] 进行排序
8. 将 B[0], B[1], ..., B[n-1] 中的元素合并成一个数组并返回
```

#### 时间复杂度分析

桶排序的时间复杂度为 $O(n)$，在最坏情况下时间复杂度为 $O(n^2)$，具体分析如下：

1. **创建桶和分配数据**：
   - 创建桶和分配数据的时间复杂度为 $O(n)$。

2. **桶内排序**：
   - 假设使用插入排序对每个桶进行排序，插入排序的时间复杂度为 $O(k_i^2)$，其中 $k_i$ 是第 $i$ 个桶中的元素数量。
   - 由于输入数据均匀分布，每个桶中的元素数量近似为 $O(1)$，因此桶内排序的总时间复杂度为 $O(n)$。

3. **合并桶**：
   - 合并所有桶中的数据，时间复杂度为 $O(n)$。

综合上述步骤，总的时间复杂度为 $O(n)$。

然而，如果输入数据不均匀分布，某些桶中的数据量很大，此时桶内排序的时间复杂度将增加到 $O(n^2)$。

#### 空间复杂度分析

桶排序需要额外的空间来存储桶和输出数组，因此空间复杂度为 $O(n + k)$，其中 $k$ 是桶的数量。

#### 稳定性

桶排序是一种稳定的排序算法，因为桶内排序算法（如插入排序）是稳定的。稳定性意味着相同元素在排序后的相对顺序保持不变。

#### 适用性

桶排序适用于以下情况：
1. **均匀分布的数据**：当输入数据均匀分布在一个已知范围内时，桶排序能达到线性时间复杂度。
2. **小规模数据**：处理小规模数据时，桶内排序的开销较小，整体效率较高。

#### 示例

假设有一个数组 $A = [0.78, 0.17, 0.39, 0.72, 0.94, 0.21, 0.12, 0.23, 0.68]$，我们使用桶排序对其进行排序，具体步骤如下：

1. **创建桶**：
   - 创建 9 个空桶 $B[0 \ldots 8]$。

2. **分配数据**：
   - 遍历数组，将每个元素分配到相应的桶中：
     - 0.78 分配到 B[7]
     - 0.17 分配到 B[1]
     - 0.39 分配到 B[3]
     - 0.72 分配到 B[7]
     - 0.94 分配到 B[8]
     - 0.21 分配到 B[2]
     - 0.12 分配到 B[1]
     - 0.23 分配到 B[2]
     - 0.68 分配到 B[6]

3. **桶内排序**：
   - 对每个非空桶中的数据进行排序，得到：
     - B[1]: [0.12, 0.17]
     - B[2]: [0.21, 0.23]
     - B[3]: [0.39]
     - B[6]: [0.68]
     - B[7]: [0.72, 0.78]
     - B[8]: [0.94]

4. **合并桶**：
   - 按顺序遍历所有桶，合并数据得到排序后的数组：[0.12, 0.17, 0.21, 0.23, 0.39, 0.68, 0.72, 0.78, 0.94]

#### 总结

桶排序是一种高效的线性时间排序算法，特别适用于均匀分布的数据。在适当的应用场景下，桶排序的时间复杂度和空间复杂度都非常理想。理解桶排序的工作原理和适用范围，对于优化特定类型数据的排序性能具有重要意义。