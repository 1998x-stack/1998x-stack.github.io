# 01_2.4.2_计数排序

"""
Lecture: 02._排序和顺序统计/2.4_线性时间排序
Content: 01_2.4.2_计数排序
"""

### 2.4.2 计数排序

计数排序（Counting Sort）是一种线性时间复杂度的非比较排序算法，适用于已知范围内的整数排序。与基于比较的排序算法（如快速排序、归并排序）不同，计数排序不通过比较元素间的大小来排序，而是通过计数各元素出现的次数来实现排序。以下是对计数排序的详细分析。

#### 基本思想

计数排序通过以下步骤实现排序：
1. **计数阶段**：统计每个元素在输入数组中的出现次数。
2. **累积计数阶段**：计算每个元素在排序后数组中的位置。
3. **排序阶段**：根据累积计数结果，将元素放置到排序后数组的正确位置。

#### 详细步骤

1. **计数阶段**：
   - 创建一个计数数组`C`，其大小为输入数组中的最大值加一（即范围内所有可能的整数数量）。
   - 初始化计数数组`C`的所有元素为0。
   - 遍历输入数组，对于每个元素`A[j]`，增加计数数组中对应元素的值，即`C[A[j]] += 1`。

2. **累积计数阶段**：
   - 修改计数数组`C`，使其包含小于或等于各元素的累积计数。具体地，对于每个`i`，`C[i]`表示小于或等于`i`的元素数量。
   - 从`C[1]`开始，累加前一个元素的计数值，即`C[i] += C[i-1]`。

3. **排序阶段**：
   - 创建一个输出数组`B`，其大小与输入数组相同。
   - 逆序遍历输入数组`A`，将每个元素`A[j]`放置到输出数组`B`的正确位置。具体地，`B[C[A[j]] - 1] = A[j]`，然后减少计数数组中对应元素的值，即`C[A[j]] -= 1`。

#### 伪代码
```
COUNTING-SORT(A, B, k)
1. let C[0..k] be a new array
2. for i = 0 to k
3.     C[i] = 0
4. for j = 1 to A.length
5.     C[A[j]] += 1
6. for i = 1 to k
7.     C[i] += C[i - 1]
8. for j = A.length downto 1
9.     B[C[A[j]]] = A[j]
10.    C[A[j]] -= 1
```

#### 时间复杂度分析

计数排序的时间复杂度为`O(n + k)`，其中`n`是输入数组的长度，`k`是输入数组中元素的取值范围。当`k = O(n)`时，计数排序的时间复杂度为`O(n)`。因此，计数排序在处理具有较小取值范围的整数数组时非常高效。

1. **初始化计数数组**：`O(k)`时间复杂度。
2. **计数阶段**：遍历输入数组，时间复杂度为`O(n)`。
3. **累积计数阶段**：遍历计数数组，时间复杂度为`O(k)`。
4. **排序阶段**：逆序遍历输入数组，时间复杂度为`O(n)`。

综合上述步骤，总的时间复杂度为`O(n + k)`。

#### 空间复杂度分析

计数排序需要额外的空间来存储计数数组`C`和输出数组`B`。因此，空间复杂度为`O(n + k)`。

#### 稳定性

计数排序是一种稳定排序算法。稳定性意味着相同元素在排序后的相对顺序保持不变。这在某些应用中非常重要，例如当需要对带有附加信息的记录进行多关键字排序时。

#### 适用性

计数排序适用于以下情况：
1. **整数排序**：输入数组中的元素为整数且取值范围已知且较小。
2. **线性时间排序**：需要在线性时间内完成排序。

#### 示例

假设有一个数组`A = [6, 0, 2, 0, 1, 3, 4, 6, 1, 3, 2]`，我们使用计数排序对其进行排序。以下是具体操作步骤：

1. **计数阶段**：
   - 初始化计数数组`C`为`[0, 0, 0, 0, 0, 0, 0]`。
   - 遍历输入数组，得到计数数组`C`为`[2, 2, 2, 2, 1, 0, 2]`。

2. **累积计数阶段**：
   - 修改计数数组`C`为`[2, 4, 6, 8, 9, 9, 11]`。

3. **排序阶段**：
   - 创建输出数组`B`为`[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]`。
   - 逆序遍历输入数组，得到排序后的数组`B`为`[0, 0, 1, 1, 2, 2, 3, 3, 4, 6, 6]`。

#### 总结

计数排序是一种高效的线性时间排序算法，特别适用于整数排序。在适当的应用场景下，计数排序的时间复杂度和空间复杂度都非常理想。理解计数排序的工作原理和适用范围，对于优化特定类型数据的排序性能具有重要意义。