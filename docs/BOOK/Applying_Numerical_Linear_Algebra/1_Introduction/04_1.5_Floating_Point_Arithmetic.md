# 04_1.5_Floating_Point_Arithmetic

"""
Lecture: /1_Introduction
Content: 04_1.5_Floating_Point_Arithmetic
"""

### 03_1.4 例子：多项式求值 (Example: Polynomial Evaluation)

#### 引言

多项式求值是数值分析中的基本问题之一。它不仅在理论上有深远的意义，而且在实际应用中也非常普遍。多项式的求值在数值计算中经常出现，例如在计算机图形学、物理模拟和金融数学等领域。

#### 多项式的定义

- **多项式形式**：一个 $d$ 次多项式可以表示为：
  $$
  p(x) = \sum_{i=0}^{d} a_i x^i
  $$
  其中，$a_i$ 是多项式的系数。

#### Horner方法

Horner方法是一种高效的多项式求值方法，通过将多项式重写为嵌套形式来减少计算的次数。

- **Horner形式**：将 $ p(x) $ 写为嵌套乘积的形式：
  $$
  p(x) = a_d + x (a_{d-1} + x (a_{d-2} + \cdots + x (a_1 + x a_0) \cdots ))
  $$
- **Horner算法**：
  $$
  p = a_d
  $$
  $$
  \text{for i = d-1 downto 0:}
  $$
  $$
  p = x * p + a_i
  $$

#### 误差分析

在进行多项式求值时，由于计算机的浮点运算精度有限，舍入误差会影响计算结果。误差分析的目的是评估和控制这些误差。

- **舍入误差模型**：假设每个浮点运算 $ * $ 和 $ + $ 都引入一个相对误差 $\delta_i$，其中 $ |\delta_i| \leq \epsilon $，$\epsilon$ 是机器精度。
  - **计算步骤中的舍入误差**：
    $$
    p_i = ((x \cdot p_{i+1})(1 + \delta_i) + a_i)(1 + \delta'_i)
    $$
    其中，$|\delta_i|, |\delta'_i| \leq \epsilon$。

- **误差传播**：
  $$
  p_0 = \sum_{i=0}^{d} (1 + \delta'_i) \left( \prod_{j=0}^{i-1} (1 + \delta_j)(1 + \delta'_j) \right) a_i x^i
  $$
  为了简化分析，可以使用上下界来近似这些乘积：
  $$
  (1 - d\epsilon) \leq \prod_{j=0}^{d-1} (1 + \delta_j) \leq (1 + d\epsilon)
  $$

- **最终误差界**：
  $$
  |p_0 - p(x)| \leq 2d\epsilon \sum_{i=0}^{d} |a_i x^i|
  $$
  这里，$\sum_{i=0}^{d} |a_i x^i|$ 是在没有正负数抵消的情况下，可能的最大计算值。

#### 条件数

条件数反映了问题对输入扰动的敏感性。在多项式求值中，条件数定义为：
  $$
  \kappa = \frac{\sum_{i=0}^{d} |a_i x^i|}{|p(x)|}
  $$
  - **高条件数**：意味着小的输入误差会导致大的输出误差。
  - **低条件数**：意味着问题对输入误差不敏感。

#### 多项式零点求解中的应用

Horner方法不仅用于多项式求值，还广泛应用于多项式的零点求解算法中，如二分法（Bisection Method）：

- **二分法步骤**：
  1. 选择一个包含根的区间 $[x_{\text{low}}, x_{\text{high}}]$，使得 $p(x_{\text{low}}) \cdot p(x_{\text{high}}) < 0$。
  2. 计算中点 $x_{\text{mid}} = (x_{\text{low}} + x_{\text{high}})/2$。
  3. 判断 $p(x_{\text{mid}})$ 的符号并缩小区间：
     - 如果 $p(x_{\text{mid}}) \cdot p(x_{\text{low}}) < 0$，则根在 $[x_{\text{low}}, x_{\text{mid}}]$。
     - 否则，根在 $[x_{\text{mid}}, x_{\text{high}}]$。
  4. 重复以上步骤，直到区间足够小。

### 深入分析

#### Horner方法的优缺点

- **优点**：
  - **计算效率高**：Horner方法通过减少乘法运算次数，提高了计算效率。对于一个 $d$ 次多项式，Horner方法只需 $d$ 次乘法和 $d$ 次加法。
  - **数值稳定性好**：Horner方法在避免数值误差累积方面表现较好，特别是在系数和变量的数值范围较大时。

- **缺点**：
  - **灵活性差**：Horner方法对多项式的特定形式（即嵌套形式）有要求，对于某些特殊多项式（如系数为大数或小数）可能不太适用。
  - **局限性**：在某些情况下，如高次多项式或复杂根的计算中，Horner方法可能会受到数值不稳定性的影响。

#### 条件数与数值稳定性

- **条件数的重要性**：条件数是评估数值问题稳定性的关键指标。高条件数意味着问题对输入误差非常敏感，可能导致不可靠的结果。
- **数值稳定性**：一个算法称为数值稳定，如果它对输入的微小扰动不敏感，能产生稳定的输出结果。Horner方法被认为是数值稳定的，因为它能有效地控制舍入误差的累积。

#### 多项式求值的实际应用

- **计算机图形学**：在图形变换和曲线绘制中，多项式求值用于计算Bezier曲线和B样条曲线的点。
- **物理模拟**：在模拟物理现象（如运动学和动力学）时，多项式求值用于计算物体的位置、速度和加速度。
- **金融数学**：在金融模型（如期权定价和风险管理）中，多项式求值用于计算收益和损失的概率分布。

通过深入分析可以看出，多项式求值是数值线性代数中的基础问题。通过选择合适的算法（如Horner方法）和进行误差分析，可以提高计算效率和结果的可靠性。条件数作为重要指标，帮助我们理解和控制计算中的数值稳定性  。

### 04_1.5 浮点运算 (Floating Point Arithmetic)

#### 引言

浮点运算是计算机在数值计算中表示实数和进行算术运算的主要方式。由于浮点数的有限精度和表示范围，浮点运算可能会引入舍入误差和溢出、下溢等问题。

#### 浮点数的表示

- **科学计数法**：浮点数通常以科学计数法表示，例如 $-3.1416$ 可以表示为：
  $$
  -0.31416 \times 10^1
  $$
  其中，符号部分表示数的正负，系数部分表示有效数字，基数表示数的底数，指数部分表示数的阶数。

- **二进制浮点数**：在计算机中，浮点数通常采用二进制表示。例如，二进制数 $.10101_2 \times 2^3 = 5.25_{10}$。
  - **规格化浮点数**：规格化的浮点数要求系数的最高位必须是非零，例如 $.10101_2 \times 2^3$ 是规格化的，而 $.010101_2 \times 2^4$ 则不是。

#### IEEE浮点数标准

- **IEEE 754标准**：大多数现代计算机采用IEEE 754标准来表示和处理浮点数。该标准定义了浮点数的格式、舍入方式、异常处理等。
  - **单精度浮点数**：32位表示，包括1位符号位、8位指数位和23位尾数位。
  - **双精度浮点数**：64位表示，包括1位符号位、11位指数位和52位尾数位。

#### 浮点数的精度和范围

- **机器

精度**：浮点数表示的最大相对误差。例如，对于单精度浮点数，机器精度约为 $2^{-24} \approx 6 \times 10^{-8}$。
- **表示范围**：浮点数能够表示的最大和最小值范围。例如，单精度浮点数的表示范围约为 $10^{-38}$ 到 $10^{38}$。

#### 浮点运算中的误差分析

- **舍入误差**：当一个浮点运算结果不能精确表示为浮点数时，需要进行舍入。舍入误差定义为：
  $$
  fl(a \pm b) = (a \pm b)(1 + \delta)
  $$
  其中，$|\delta|$ 是一个小量，表示相对舍入误差。
- **溢出和下溢**：当计算结果超出浮点数表示范围时，会发生溢出（结果为正无穷或负无穷）或下溢（结果为零或次正规数）。

#### 浮点运算的特殊值和异常处理

- **特殊值**：IEEE 754标准定义了几种特殊值，用于处理异常情况：
  - **正无穷和负无穷**：用于表示溢出的结果。
  - **NaN（Not a Number）**：用于表示未定义或无效的运算结果，例如 $0/0$、$\sqrt{-1}$ 等。

- **异常处理**：当发生浮点异常（如溢出、下溢、无效操作等）时，IEEE 754标准定义了相应的异常标志，程序可以检测并处理这些异常。

### 深入分析

#### 浮点数表示的优缺点

- **优点**：
  - **动态范围大**：浮点数能够表示非常大和非常小的数，适用于各种科学和工程计算。
  - **标准化**：IEEE 754标准提供了统一的浮点数表示和运算规则，提高了计算的可移植性和可靠性。

- **缺点**：
  - **精度有限**：由于浮点数的有限精度，可能会引入舍入误差，影响计算结果的准确性。
  - **复杂性高**：浮点数运算涉及溢出、下溢、舍入等复杂情况，需要仔细处理。

#### 浮点运算中的数值稳定性

- **数值稳定性**：在数值计算中，一个算法称为数值稳定，如果它对输入的微小扰动不敏感，能产生稳定的输出结果。浮点运算中的数值稳定性取决于算法的设计和实现。
  - **舍入误差的累积**：在多次浮点运算中，舍入误差可能会累积，导致结果偏离真实值。设计数值稳定的算法需要考虑控制舍入误差的累积。

#### 浮点运算的实际应用

- **科学计算**：在科学研究中，浮点运算用于模拟物理、化学、生物等复杂系统。例如，在气象模拟中，需要高精度的浮点运算来计算大气和海洋的变化。
- **工程设计**：在工程领域，浮点运算用于结构分析、热力学计算、电路设计等。例如，在飞机设计中，需要使用浮点运算来模拟和分析飞行器的受力和变形。
- **金融计算**：在金融领域，浮点运算用于风险管理、期权定价、投资组合优化等。例如，在期权定价中，需要使用浮点运算来模拟市场波动和计算期权价格。