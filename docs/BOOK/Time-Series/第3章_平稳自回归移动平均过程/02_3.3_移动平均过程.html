
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <title>3.3 移动平均过程</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=STIX+Two+Math&display=swap">
  <link rel="stylesheet" href="../markdown.css">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="../markdown.js"></script>
</head>
<body>
  <div class="container">
    <h1>02_3.3 移动平均过程</h1>
<pre><code>Lecture: /第3章 平稳自回归移动平均过程
Content: 02_3.3 移动平均过程
</code></pre>
<h3>第3章 平稳自回归移动平均过程</h3>
<h4>3.3 移动平均过程</h4>
<p>移动平均过程（Moving Average Process，简称 MA 过程）是时间序列分析中的一种重要模型。它用于描述时间序列数据的短期相关性和随机波动。第3章第3.3节详细介绍了移动平均过程的定义、性质及其在时间序列建模中的应用。</p>
<h4>移动平均过程的定义</h4>
<p>移动平均过程是指当前时间序列值由当前和若干前期的误差项的线性组合所决定。一般形式的 MA(q) 模型可以表示为：</p>
<p>$$ X_t = \mu + Z_t + \theta_1 Z_{t-1} + \theta_2 Z_{t-2} + \cdots + \theta_q Z_{t-q} $$</p>
<p>其中：</p>
<ul>
<li>$ X_t $ 是时间序列在时间 $ t $ 的值。</li>
<li>$ \mu $ 是常数项，表示序列的均值。</li>
<li>$ Z_t $ 是白噪声序列，即均值为零且方差为 $ \sigma^2 $ 的独立同分布随机变量。</li>
<li>$ \theta_1, \theta_2, \cdots, \theta_q $ 是模型参数。</li>
</ul>
<h4>移动平均过程的性质</h4>
<ol>
<li><strong>平稳性</strong>：MA(q) 过程是平稳的，因为其均值、方差和自协方差函数不随时间变化。具体来说，均值为 $ \mu $，方差为：</li>
</ol>
<p>$$ \text{Var}(X_t) = \sigma^2 (1 + \theta_1^2 + \theta_2^2 + \cdots + \theta_q^2) $$</p>
<p>自协方差函数仅在有限的滞后阶数 $ q $ 内非零。</p>
<ol start="2">
<li>
<p><strong>自相关函数</strong>：自相关函数（ACF）在滞后 $ k &gt; q $ 时为零。这一性质使得 MA 模型在识别和估计时比较方便。</p>
</li>
<li>
<p><strong>因果性和可逆性</strong>：MA 过程是因果的，因为当前值 $ X_t $ 仅由当前和过去的误差项决定。对于可逆性，MA 模型的参数必须满足一定条件，即模型可以转换为 AR 模型表示。</p>
</li>
</ol>
<h4>移动平均过程的应用</h4>
<p>移动平均过程在时间序列分析中有广泛的应用，特别是在建模和预测短期波动时具有优势。以下是几个典型的应用场景：</p>
<ol>
<li><strong>金融市场分析</strong>：在股票价格、汇率等金融数据中，MA 模型常用于捕捉短期价格波动。</li>
<li><strong>经济指标分析</strong>：经济数据如消费指数、失业率等，可以通过 MA 模型分析其短期变化趋势。</li>
<li><strong>工程和信号处理</strong>：在信号处理中，MA 模型用于滤波和噪声消除，帮助提取有用信号。</li>
</ol>
<h4>MA 过程的模型识别和估计</h4>
<ol>
<li>
<p><strong>模型识别</strong>：通过分析时间序列的 ACF 图，可以确定 MA 模型的阶数。ACF 在滞后 $ q $ 之后迅速衰减为零，是识别 MA(q) 模型的关键特征。</p>
</li>
<li>
<p><strong>参数估计</strong>：常用的方法包括最小二乘法和极大似然估计法。通过历史数据，可以估计模型参数 $ \theta_1, \theta_2, \cdots, \theta_q $。</p>
</li>
<li>
<p><strong>模型验证</strong>：通过残差分析和诊断检查，验证所建模型的合理性和有效性。残差应呈现白噪声特性，即均值为零且无自相关。</p>
</li>
</ol>
<h3>实例分析</h3>
<p>假设我们有一个 MA(1) 模型：</p>
<p>$$ X_t = Z_t + \theta Z_{t-1} $$</p>
<p>我们可以通过以下步骤进行分析和建模：</p>
<ol>
<li><strong>识别模型</strong>：通过绘制时间序列的 ACF 图，发现 ACF 在滞后1时显著，滞后2及以后迅速衰减为零，初步确定为 MA(1) 模型。</li>
<li><strong>估计参数</strong>：使用历史数据，采用极大似然估计法估计参数 $ \theta $。</li>
<li><strong>验证模型</strong>：分析残差的 ACF 图，检查残差是否呈现白噪声特性，若满足，则模型有效。</li>
</ol>
<h3>总结</h3>
<p>移动平均过程是时间序列分析中的基础模型，通过描述时间序列的短期相关性，提供了有效的建模和预测方法。理解和掌握 MA 模型的定义、性质和应用，有助于更准确地分析和预测实际时间序列数据。</p>

    <h3>Python 文件</h3>
    <pre><code># 02_3.3 移动平均过程

"""
Lecture: /第3章 平稳自回归移动平均过程
Content: 02_3.3 移动平均过程
"""

import numpy as np
from typing import List

class MovingAverageProcess:
    def __init__(self, mean: float, theta: List[float]):
        """
        Initialize the Moving Average Process.

        Parameters:
        mean (float): Mean of the process.
        theta (List[float]): List of coefficients for the MA process.
        """
        self.mean = mean
        self.theta = np.array(theta)
        self.q = len(theta)  # Order of the MA process
        
    def generate_samples(self, n_samples: int):
        """
        Generate samples from the Moving Average Process.

        Parameters:
        n_samples (int): Number of samples to generate.

        Returns:
        np.ndarray: Array of shape (n_samples,) containing MA process samples.
        """
        # Generate white noise samples
        white_noise = np.random.normal(size=n_samples)
        
        # Initialize array to store MA process samples
        samples = np.zeros(n_samples)
        
        for t in range(self.q, n_samples):
            # Calculate MA process value at time t
            samples[t] = self.mean + np.sum(self.theta * white_noise[t-self.q:t])
        
        return samples

# Example usage
if __name__ == "__main__":
    # Define parameters for the MA process
    mean = 0.0
    theta = [0.5, -0.3]  # Example coefficients for the MA process, e.g., MA(2) process
    
    # Create MA process object
    ma_process = MovingAverageProcess(mean, theta)
    
    # Generate MA process samples
    n_samples = 100
    ma_samples = ma_process.generate_samples(n_samples)
    
    # Print the generated samples
    print("Generated MA process samples:")
    print(ma_samples)
</code></pre>
  </div>
</body>
</html>
  