
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <title>3.5 混合自回归移动平均过程</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=STIX+Two+Math&display=swap">
  <link rel="stylesheet" href="../markdown.css">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="../markdown.js"></script>
</head>
<body>
  <div class="container">
    <h1>04_3.5 混合自回归移动平均过程</h1>
<pre><code>Lecture: /第3章 平稳自回归移动平均过程
Content: 04_3.5 混合自回归移动平均过程
</code></pre>
<h3>第3章 平稳自回归移动平均过程</h3>
<h4>3.5 混合自回归移动平均过程</h4>
<p>混合自回归移动平均过程（Autoregressive Moving Average Process，简称ARMA过程）是时间序列分析中的一种重要模型，它结合了自回归过程（AR过程）和移动平均过程（MA过程）的特性，能够有效捕捉时间序列数据中的短期和长期相关性。第3章第3.5节详细介绍了ARMA过程的定义、性质及其在实际中的应用。</p>
<h4>混合自回归移动平均过程的定义</h4>
<p>ARMA(p,q)模型结合了AR(p)和MA(q)模型的特性，其一般形式可以表示为：</p>
<p>$$ X_t = \phi_1 X_{t-1} + \phi_2 X_{t-2} + \cdots + \phi_p X_{t-p} + \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \cdots + \theta_q \epsilon_{t-q} $$</p>
<p>其中：</p>
<ul>
<li>$ X_t $ 是时间序列在时间 $ t $ 的值。</li>
<li>$ \phi_1, \phi_2, \cdots, \phi_p $ 是AR部分的模型参数。</li>
<li>$ \theta_1, \theta_2, \cdots, \theta_q $ 是MA部分的模型参数。</li>
<li>$ \epsilon_t $ 是白噪声序列，即均值为零且方差为 $ \sigma^2 $ 的独立同分布随机变量。</li>
</ul>
<h4>混合自回归移动平均过程的性质</h4>
<ol>
<li><strong>平稳性</strong>：ARMA过程的平稳性取决于其AR部分的特征方程的根。如果特征方程的所有根都在单位圆之外，则该过程是平稳的。特征方程为：</li>
</ol>
<p>$$ 1 - \phi_1 z - \phi_2 z^2 - \cdots - \phi_p z^p = 0 $$</p>
<ol start="2">
<li>
<p><strong>自相关函数和偏自相关函数</strong>：ARMA过程的自相关函数（ACF）和偏自相关函数（PACF）结合了AR过程和MA过程的特性。在滞后较小的情况下，ACF和PACF都呈现复杂的衰减模式。</p>
</li>
<li>
<p><strong>因果性和可逆性</strong>：ARMA过程的因果性取决于其AR部分的参数，而可逆性取决于其MA部分的参数。因果性和可逆性是确保模型能够合理描述时间序列动态特性的关键。</p>
</li>
</ol>
<h4>混合自回归移动平均过程的应用</h4>
<p>ARMA过程在时间序列分析中有广泛的应用，特别是在建模和预测时间序列数据时具有重要作用。以下是几个典型的应用场景：</p>
<ol>
<li><strong>经济和金融数据分析</strong>：在股票价格、利率等金融数据中，ARMA模型常用于描述和预测数据的短期波动和长期趋势。</li>
<li><strong>气象数据分析</strong>：气象数据如温度、降水量等，可以通过ARMA模型分析其变化趋势和周期性。</li>
<li><strong>工程和信号处理</strong>：在工程应用中，ARMA模型用于分析和预测信号的动态变化，如电力负荷预测等。</li>
</ol>
<h4>ARMA过程的模型识别和估计</h4>
<ol>
<li>
<p><strong>模型识别</strong>：通过分析时间序列的自相关函数（ACF）和偏自相关函数（PACF）图，可以初步确定ARMA模型的阶数。一般来说，ACF和PACF在滞后较小的情况下会呈现复杂的衰减模式，结合实际数据进行模型选择。</p>
</li>
<li>
<p><strong>参数估计</strong>：常用的方法包括最小二乘法和极大似然估计法。通过历史数据，可以估计模型参数 $ \phi_1, \phi_2, \cdots, \phi_p $ 和 $ \theta_1, \theta_2, \cdots, \theta_q $。</p>
</li>
<li>
<p><strong>模型验证</strong>：通过残差分析和诊断检查，验证所建模型的合理性和有效性。残差应呈现白噪声特性，即均值为零且无自相关。</p>
</li>
</ol>
<h3>实例分析</h3>
<p>假设我们有一个ARMA(1,1)模型：</p>
<p>$$ X_t = \phi_1 X_{t-1} + \epsilon_t + \theta_1 \epsilon_{t-1} $$</p>
<p>我们可以通过以下步骤进行分析和建模：</p>
<ol>
<li><strong>识别模型</strong>：通过绘制时间序列的ACF和PACF图，发现ACF和PACF在滞后1时显著，初步确定为ARMA(1,1)模型。</li>
<li><strong>估计参数</strong>：使用历史数据，采用极大似然估计法估计参数 $ \phi_1 $ 和 $ \theta_1 $。</li>
<li><strong>验证模型</strong>：分析残差的ACF图，检查残差是否呈现白噪声特性，若满足，则模型有效。</li>
</ol>
<h3>总结</h3>
<p>混合自回归移动平均过程是时间序列分析中的基础模型，通过结合AR过程和MA过程的特性，提供了有效的建模和预测方法。理解和掌握ARMA模型的定义、性质和应用，有助于更准确地分析和预测实际时间序列数据。这些模型在经济、金融、气象、工程等领域具有广泛的应用，为实际问题的解决提供了科学依据。</p>

    <h3>Python 文件</h3>
    <pre><code># 04_3.5 混合自回归移动平均过程

"""
Lecture: /第3章 平稳自回归移动平均过程
Content: 04_3.5 混合自回归移动平均过程
"""

import numpy as np
from typing import List, Tuple

class ARMAProcess:
    """
    混合自回归移动平均过程 (ARMA) 类，用于生成和分析 ARMA(p, q) 模型。

    Attributes:
        ar_params (List[float]): AR 模型的参数列表
        ma_params (List[float]): MA 模型的参数列表
    """

    def __init__(self, ar_params: List[float], ma_params: List[float]):
        """
        初始化 ARMA 过程。

        Args:
            ar_params (List[float]): AR 模型的参数列表
            ma_params (List[float]): MA 模型的参数列表
        """
        self.ar_params = np.array(ar_params)
        self.ma_params = np.array(ma_params)
        self.p = len(ar_params)  # AR 模型的阶数
        self.q = len(ma_params)  # MA 模型的阶数
    
    def generate_samples(self, n_samples: int, noise_variance: float = 1.0) -> np.ndarray:
        """
        生成 ARMA 过程的样本序列。

        Args:
            n_samples (int): 生成样本的数量
            noise_variance (float): 噪声方差，默认值为 1.0

        Returns:
            np.ndarray: 生成的 ARMA 过程样本序列
        """
        # 初始化样本序列
        samples = np.zeros(n_samples)
        # 生成白噪声序列
        white_noise = np.random.normal(scale=np.sqrt(noise_variance), size=n_samples)
        
        # 生成 ARMA 过程样本
        for t in range(max(self.p, self.q), n_samples):
            ar_component = np.dot(self.ar_params, samples[t-self.p:t][::-1])
            ma_component = np.dot(self.ma_params, white_noise[t-self.q:t][::-1])
            samples[t] = ar_component + white_noise[t] + ma_component
        
        return samples

    def estimate_parameters(self, samples: np.ndarray) -> Tuple[np.ndarray, np.ndarray]:
        """
        使用极大似然估计法估计 ARMA 模型参数。

        Args:
            samples (np.ndarray): 样本序列

        Returns:
            Tuple[np.ndarray, np.ndarray]: 估计的 AR 模型参数和 MA 模型参数
        """
        from statsmodels.tsa.arima.model import ARIMA
        
        # 使用 statsmodels 库估计 ARMA 模型参数
        model = ARIMA(samples, order=(self.p, 0, self.q))
        model_fit = model.fit()
        
        ar_params_estimated = model_fit.arparams
        ma_params_estimated = model_fit.maparams
        
        return ar_params_estimated, ma_params_estimated

    def predict_n(self, n: int, history: np.ndarray) -> np.ndarray:
        """
        预测未来 n 步的值，并在每一步后重新拟合模型并获取新参数。

        Args:
            n (int): 要预测的步数
            history (np.ndarray): 历史数据

        Returns:
            np.ndarray: 预测的未来 n 步的值
        """
        predictions = np.zeros(n)
        extended_history = np.append(history, predictions)
        
        for t in range(n):
            # 重新估计参数
            current_history = extended_history[:len(history) + t]
            self.ar_params, self.ma_params = self.estimate_parameters(current_history)
            
            if t < self.q:
                ma_component = np.dot(self.ma_params[:t], extended_history[-t-1:-1][::-1])
            else:
                ma_component = np.dot(self.ma_params, extended_history[-self.q-1:-1][::-1])
                
            if t < self.p:
                ar_component = np.dot(self.ar_params[:t], extended_history[-t-1:-1][::-1])
            else:
                ar_component = np.dot(self.ar_params, extended_history[-self.p-1:-1][::-1])
                
            predictions[t] = ar_component + ma_component
            extended_history[len(history) + t] = predictions[t]
        
        return predictions

def main():
    """
    主函数，演示混合自回归移动平均过程的使用。
    """
    # 定义 ARMA(2, 2) 模型的参数
    ar_params = [0.75, -0.25]
    ma_params = [0.65, 0.35]
    arma_process = ARMAProcess(ar_params, ma_params)
    
    # 生成 ARMA 过程样本
    n_samples = 100
    noise_variance = 1.0
    samples = arma_process.generate_samples(n_samples, noise_variance)
    
    # 打印生成的样本序列的前 10 个值
    print("Generated ARMA process samples (first 10 samples):")
    print(samples[:10])
    
    # 使用极大似然估计法估计 ARMA 模型参数
    estimated_ar_params, estimated_ma_params = arma_process.estimate_parameters(samples)
    
    # 打印估计的参数
    print("Estimated AR parameters:")
    print(estimated_ar_params)
    print("Estimated MA parameters:")
    print(estimated_ma_params)
    
    # 预测未来 10 步的值
    history = samples[-max(len(ar_params), len(ma_params)):]  # 取最后的历史数据
    predictions = arma_process.predict_n(10, history)
    
    # 打印预测值
    print("Predicted future values:")
    print(predictions)

if __name__ == "__main__":
    main()</code></pre>
  </div>
</body>
</html>
  